<!doctype html>
<html lang="en" data-bs-theme="dark">
  <head>
    <script src="https://cdn.jsdelivr.net/npm/appwrite@latest"></script>
    <script src="./js/color-modes.js"></script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Official Website of the Codax Community">
    <meta property="og:description" content="Opisyal nga Website sang Komunidad sang Codax "/>
    <meta name="author" content="Trion05">
    <meta name="generator" content="Hugo 0.122.0">
    <title>The Codax Official</title>

    <link href="./style/css/bootstrap.min.css" rel="stylesheet">
    <link href="./style/style.css" rel="stylesheet">
    <link href="./img/logo.png" rel="icon" type="image">

    <style>
      /* Add custom CSS here */
    </style>

    <script>
      // Initialize Appwrite SDK
      const client = new Appwrite.Client();
      const databases = new Appwrite.Databases(client);

      client
        .setEndpoint('https://cloud.appwrite.io/v1') 
        .setProject('[codaxwebsite]');                

      // Fetch blogs dynamically
      async function fetchBlogs() {
        const databaseId = '[codaxwebsite]';        
        const collectionId = '[blogs]'; 

        try {
          const response = await databases.listDocuments(codaxwebsite, blogs);
          const blogsContainer = document.getElementById('blogs-container');
          blogsContainer.innerHTML = '';

          response.documents.forEach(blog => {
            const blogHTML = `
              <div class="mb-0">
                <h1>${blog.title}</h1>
                <p class="blog-post-meta">${new Date(blog.createdAt).toDateString()} by ${blog.author}</p>
                <p>${blog.content.substring(0, 150)}...</p>
                <a href="./section/blogs/blog_${blog.$id}.html" class="icon-link gap-1 icon-link-hover stretched-link">Continue reading</a>
              </div>
              <br>`;
            blogsContainer.innerHTML += blogHTML;
          });
        } catch (error) {
          console.error('Error fetching blogs:', error);
        }
      }

      // Fetch challenges dynamically
      async function fetchChallenges() {
        const databaseId = '[codaxwebsite]';           
        const collectionId = '[challenges]'; 

        try {
          const response = await databases.listDocuments(databaseId, collectionId);
          const challengesContainer = document.getElementById('challenges-container');
          challengesContainer.innerHTML = '';

          response.documents.forEach(challenge => {
            const challengeHTML = `
              <li>
                <a class="d-flex flex-column flex-lg-row gap-3 align-items-start align-items-lg-center py-3 link-body-emphasis text-decoration-none border-top" href="#">
                  <img class="cht" src="${challenge.iconUrl}">
                  <div class="col-lg-8">
                    <h6 class="mb-0">${challenge.title}</h6>
                    <small class="text-body-secondary">${challenge.author}</small>
                  </div>
                </a>
              </li>`;
            challengesContainer.innerHTML += challengeHTML;
          });
        } catch (error) {
          console.error('Error fetching challenges:', error);
        }
      }

      // Call APIs on page load
      document.addEventListener('DOMContentLoaded', () => {
        fetchBlogs();
        fetchChallenges();
      });
    </script>
  </head>
  <body>
    <div class="container">
      <!-- Header Section -->
      <header class="border-bottom lh-1 py-3">
        <div class="row flex-nowrap justify-content-center align-items-center">
          <div class="col-4 pt-1">
            <img src="./img/alt_logo.png" class="icon">
          </div>
          <div class="col-4 text-center">
            <a class="blog-header-logo text-body-emphasis text-decoration-none" href="#">Codax</a>
          </div>
          <div class="col-4 d-flex justify-content-end align-items-center">
            <a class="btn btn-sm btn-outline-secondary" href="#">Join Us</a>
          </div>
        </div>
      </header>

      <!-- Navigation -->
      <div class="nav-scroller py-1 mb-3 border-bottom">
        <nav class="nav nav-underline justify-content-center">
          <a class="nav-item nav-link link-body-emphasis active" href="./index.html">Home</a>
          <a class="nav-item nav-link link-body-emphasis active" href="#">Challenges</a>
          <a class="nav-item nav-link link-body-emphasis active" href="#">Events</a>
          <a class="nav-item nav-link link-body-emphasis active" href="./index.html#blogs">Blogs</a>
          <a class="nav-item nav-link link-body-emphasis active" href="./section/about_us.html">About Us</a>
        </nav>
      </div>

      <!-- Main Content -->
      <main class="container">
        <!-- Hero Section -->
        <div class="p-4 p-md-5 mb-4 rounded text-body-emphasis bg-body-secondary text-center">
          <img src="./img/logo.png" height="200vh"><br>
          <h1>CODAX</h1>
        </div>

        <!-- Blogs Section -->
        <div id="blogs-container">
          <h3 id="blogs" class="pb-4 mb-4 fst-italic border-bottom">Blogs</h3>
          <p>Loading blogs...</p>
        </div>

        <!-- Challenges Section -->
        <div id="challenges-container" class="p-4">
          <h4 class="fst-italic">Recent Challenges</h4>
          <ul class="list-unstyled">
            <li>Loading challenges...</li>
          </ul>
        </div>
      </main>

      <!-- Footer -->
      <footer class="py-5 text-center text-body-secondary bg-body-tertiary">
        Codax Official Website
      </footer>
    </div>

    <script src="./js/bootstrap.bundle.min.js"></script>
  </body>
</html>
